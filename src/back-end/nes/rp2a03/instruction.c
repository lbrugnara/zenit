#include <inttypes.h>
#include <fllib/Mem.h>
#include <fllib/Cstring.h>
#include "instruction.h"


static Rp2a03Instruction instructions[] = 
{
    [0x00] = { NES_OP_BRK, NES_ADDR_IMP, 1, "BRK"                           },
    [0x01] = { NES_OP_ORA, NES_ADDR_INX, 2, "ORA ($%02"PRIX8",X)"           },
    [0x02] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x03] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x04] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x05] = { NES_OP_ORA, NES_ADDR_ZPG, 2, "ORA $%02"PRIX8                 },
    [0x06] = { NES_OP_ASL, NES_ADDR_ZPG, 2, "ASL $%02"PRIX8                 },
    [0x07] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x08] = { NES_OP_PHP, NES_ADDR_IMP, 1, "PHP"                           },
    [0x09] = { NES_OP_ORA, NES_ADDR_IMM, 2, "ORA #$%02"PRIX8                },
    [0x0a] = { NES_OP_ASL, NES_ADDR_IMP, 1, "ASL"                           },
    [0x0b] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x0c] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x0d] = { NES_OP_ORA, NES_ADDR_ABS, 3, "ORA $%02"PRIX8"%02"PRIX8       },
    [0x0e] = { NES_OP_ASL, NES_ADDR_ABS, 3, "ASL $%02"PRIX8"%02"PRIX8       },
    [0x0f] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x10] = { NES_OP_BPL, NES_ADDR_REL, 2, "BPL $%02"PRIX8                 },
    [0x11] = { NES_OP_ORA, NES_ADDR_INY, 2, "ORA ($%02"PRIX8"),Y"           },
    [0x12] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x13] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x14] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x15] = { NES_OP_ORA, NES_ADDR_ZPX, 2, "ORA $%02"PRIX8",X"             },
    [0x16] = { NES_OP_ASL, NES_ADDR_ZPX, 2, "ASL $%02"PRIX8",X"             },
    [0x17] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x18] = { NES_OP_CLC, NES_ADDR_IMP, 1, "CLC"                           },
    [0x19] = { NES_OP_ORA, NES_ADDR_ABY, 3, "ORA $%02"PRIX8"%02"PRIX8",Y"   },
    [0x1a] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x1b] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x1c] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x1d] = { NES_OP_ORA, NES_ADDR_ABX, 3, "ORA $%02"PRIX8"%02"PRIX8",X"   },
    [0x1e] = { NES_OP_ASL, NES_ADDR_ABX, 3, "ASL $%02"PRIX8"%02"PRIX8",X"   },
    [0x1f] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x20] = { NES_OP_JSR, NES_ADDR_ABS, 3, "JSR $%02"PRIX8"%02"PRIX8       },
    [0x21] = { NES_OP_AND, NES_ADDR_INX, 2, "AND ($%02"PRIX8",X)"           },
    [0x22] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x23] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x24] = { NES_OP_BIT, NES_ADDR_ZPG, 2, "BIT $%02"PRIX8                 },
    [0x25] = { NES_OP_AND, NES_ADDR_ZPG, 2, "AND $%02"PRIX8                 },
    [0x26] = { NES_OP_ROL, NES_ADDR_ZPG, 2, "ROL $%02"PRIX8                 },
    [0x27] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x28] = { NES_OP_PLP, NES_ADDR_IMP, 1, "PLP"                           },
    [0x29] = { NES_OP_AND, NES_ADDR_IMM, 2, "AND #$%02"PRIX8                },
    [0x2a] = { NES_OP_ROL, NES_ADDR_IMP, 1, "ROL"                           },
    [0x2b] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x2c] = { NES_OP_BIT, NES_ADDR_ABS, 3, "BIT $%02"PRIX8"%02"PRIX8       },
    [0x2d] = { NES_OP_AND, NES_ADDR_ABS, 3, "AND $%02"PRIX8"%02"PRIX8       },
    [0x2e] = { NES_OP_ROL, NES_ADDR_ABS, 3, "ROL $%02"PRIX8"%02"PRIX8       },
    [0x2f] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x30] = { NES_OP_BMI, NES_ADDR_REL, 2, "BMI $%02"PRIX8                 },
    [0x31] = { NES_OP_AND, NES_ADDR_INY, 2, "AND ($%02"PRIX8"),Y"           },
    [0x32] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x33] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x34] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x35] = { NES_OP_AND, NES_ADDR_ZPX, 2, "AND $%02"PRIX8",X"             },
    [0x36] = { NES_OP_ROL, NES_ADDR_ZPX, 2, "ROL $%02"PRIX8",X"             },
    [0x37] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x38] = { NES_OP_SEC, NES_ADDR_IMP, 1, "SEC"                           },
    [0x39] = { NES_OP_AND, NES_ADDR_ABY, 3, "AND $%02"PRIX8"%02"PRIX8",Y"   },
    [0x3a] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x3b] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x3c] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x3d] = { NES_OP_AND, NES_ADDR_ABX, 3, "AND $%02"PRIX8"%02"PRIX8",X"   },
    [0x3e] = { NES_OP_ROL, NES_ADDR_ABX, 3, "ROL $%02"PRIX8"%02"PRIX8",X"   },
    [0x3f] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x40] = { NES_OP_RTI, NES_ADDR_IMP, 1, "RTI"                           },
    [0x41] = { NES_OP_EOR, NES_ADDR_INX, 2, "EOR ($%02"PRIX8",X)"           },
    [0x42] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x43] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x44] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x45] = { NES_OP_EOR, NES_ADDR_ZPG, 2, "EOR $%02"PRIX8                 },
    [0x46] = { NES_OP_LSR, NES_ADDR_ZPG, 2, "LSR $%02"PRIX8                 },
    [0x47] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x48] = { NES_OP_PHA, NES_ADDR_IMP, 1, "PHA"                           },
    [0x49] = { NES_OP_EOR, NES_ADDR_IMM, 2, "EOR #$%02"PRIX8                },
    [0x4a] = { NES_OP_LSR, NES_ADDR_IMP, 1, "LSR"                           },
    [0x4b] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x4c] = { NES_OP_JMP, NES_ADDR_ABS, 3, "JMP $%02"PRIX8"%02"PRIX8       },
    [0x4d] = { NES_OP_EOR, NES_ADDR_ABS, 3, "EOR $%02"PRIX8"%02"PRIX8       },
    [0x4e] = { NES_OP_LSR, NES_ADDR_ABS, 3, "LSR $%02"PRIX8"%02"PRIX8       },
    [0x4f] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x50] = { NES_OP_BVC, NES_ADDR_REL, 2, "BVC $%02"PRIX8                 },
    [0x51] = { NES_OP_EOR, NES_ADDR_INY, 2, "EOR ($%02"PRIX8"),Y"           },
    [0x52] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x53] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x54] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x55] = { NES_OP_EOR, NES_ADDR_ZPX, 2, "EOR $%02"PRIX8",X"             },
    [0x56] = { NES_OP_LSR, NES_ADDR_ZPX, 2, "LSR $%02"PRIX8",X"             },
    [0x57] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x58] = { NES_OP_CLI, NES_ADDR_IMP, 1, "CLI"                           },
    [0x59] = { NES_OP_EOR, NES_ADDR_ABY, 3, "EOR $%02"PRIX8"%02"PRIX8",Y"   },
    [0x5a] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x5b] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x5c] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x5d] = { NES_OP_EOR, NES_ADDR_ABX, 3, "EOR $%02"PRIX8"%02"PRIX8",X"   },
    [0x5e] = { NES_OP_LSR, NES_ADDR_ABX, 3, "LSR $%02"PRIX8"%02"PRIX8",X"   },
    [0x5f] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x60] = { NES_OP_RTS, NES_ADDR_IMP, 1, "RTS"                           },
    [0x61] = { NES_OP_ADC, NES_ADDR_INX, 2, "ADC ($%02"PRIX8",X)"           },
    [0x62] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x63] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x64] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x65] = { NES_OP_ADC, NES_ADDR_ZPG, 2, "ADC $%02"PRIX8                 },
    [0x66] = { NES_OP_ROR, NES_ADDR_ZPG, 2, "ROR $%02"PRIX8                 },
    [0x67] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x68] = { NES_OP_PLA, NES_ADDR_IMP, 1, "PLA"                           },
    [0x69] = { NES_OP_ADC, NES_ADDR_IMM, 2, "ADC #$%02"PRIX8                },
    [0x6a] = { NES_OP_ROR, NES_ADDR_IMP, 1, "ROR"                           },
    [0x6b] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x6c] = { NES_OP_JMP, NES_ADDR_IND, 3, "JMP ($%02"PRIX8"%02"PRIX8")"   },
    [0x6d] = { NES_OP_ADC, NES_ADDR_ABS, 3, "ADC $%02"PRIX8"%02"PRIX8       },
    [0x6e] = { NES_OP_ROR, NES_ADDR_ABS, 3, "ROR $%02"PRIX8"%02"PRIX8       },
    [0x6f] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x70] = { NES_OP_BVS, NES_ADDR_REL, 2, "BVS $%02"PRIX8                 },
    [0x71] = { NES_OP_ADC, NES_ADDR_INY, 2, "ADC ($%02"PRIX8"),Y"           },
    [0x72] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x73] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x74] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x75] = { NES_OP_ADC, NES_ADDR_ZPX, 2, "ADC $%02"PRIX8",X"             },
    [0x76] = { NES_OP_ROR, NES_ADDR_ZPX, 2, "ROR $%02"PRIX8",X"             },
    [0x77] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x78] = { NES_OP_SEI, NES_ADDR_IMP, 1, "SEI"                           },
    [0x79] = { NES_OP_ADC, NES_ADDR_ABY, 3, "ADC $%02"PRIX8"%02"PRIX8",Y"   },
    [0x7a] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x7b] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x7c] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x7d] = { NES_OP_ADC, NES_ADDR_ABX, 3, "ADC $%02"PRIX8"%02"PRIX8",X"   },
    [0x7e] = { NES_OP_ROR, NES_ADDR_ABX, 3, "ROR $%02"PRIX8"%02"PRIX8",X"   },
    [0x7f] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x80] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x81] = { NES_OP_STA, NES_ADDR_INX, 2, "STA ($%02"PRIX8",X)"           },
    [0x82] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x83] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x84] = { NES_OP_STY, NES_ADDR_ZPG, 2, "STY $%02"PRIX8                 },
    [0x85] = { NES_OP_STA, NES_ADDR_ZPG, 2, "STA $%02"PRIX8                 },
    [0x86] = { NES_OP_STX, NES_ADDR_ZPG, 2, "STX $%02"PRIX8                 },
    [0x87] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x88] = { NES_OP_DEY, NES_ADDR_IMP, 1, "DEY"                           },
    [0x89] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x8a] = { NES_OP_TXA, NES_ADDR_IMP, 1, "TXA"                           },
    [0x8b] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x8c] = { NES_OP_STY, NES_ADDR_ABS, 3, "STY $%02"PRIX8"%02"PRIX8       },
    [0x8d] = { NES_OP_STA, NES_ADDR_ABS, 3, "STA $%02"PRIX8"%02"PRIX8       },
    [0x8e] = { NES_OP_STX, NES_ADDR_ABS, 3, "STX $%02"PRIX8"%02"PRIX8       },
    [0x8f] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x90] = { NES_OP_BCC, NES_ADDR_REL, 2, "BCC $%02"PRIX8                 },
    [0x91] = { NES_OP_STA, NES_ADDR_INY, 2, "STA ($%02"PRIX8"),Y"           },
    [0x92] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x93] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x94] = { NES_OP_STY, NES_ADDR_ZPX, 2, "STY $%02"PRIX8",X"             },
    [0x95] = { NES_OP_STA, NES_ADDR_ZPX, 2, "STA $%02"PRIX8",X"             },
    [0x96] = { NES_OP_STX, NES_ADDR_ZPY, 2, "STX $%02"PRIX8",Y"             },
    [0x97] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x98] = { NES_OP_TYA, NES_ADDR_IMP, 1, "TYA"                           },
    [0x99] = { NES_OP_STA, NES_ADDR_ABY, 3, "STA $%02"PRIX8"%02"PRIX8",Y"   },
    [0x9a] = { NES_OP_TXS, NES_ADDR_IMP, 1, "TXS"                           },
    [0x9b] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x9c] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0x9d] = { NES_OP_STA, NES_ADDR_ABX, 3, "STA $%02"PRIX8"%02"PRIX8",X"   },
    [0x9e] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0x9f] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xa0] = { NES_OP_LDY, NES_ADDR_IMM, 2, "LDY #$%02"PRIX8                },
    [0xa1] = { NES_OP_LDA, NES_ADDR_INX, 2, "LDA ($%02"PRIX8",X)"           },
    [0xa2] = { NES_OP_LDX, NES_ADDR_IMM, 2, "LDX #$%02"PRIX8                },
    [0xa3] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xa4] = { NES_OP_LDY, NES_ADDR_ZPG, 2, "LDY $%02"PRIX8                 },
    [0xa5] = { NES_OP_LDA, NES_ADDR_ZPG, 2, "LDA $%02"PRIX8                 },
    [0xa6] = { NES_OP_LDX, NES_ADDR_ZPG, 2, "LDX $%02"PRIX8                 },
    [0xa7] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xa8] = { NES_OP_TAY, NES_ADDR_IMP, 1, "TAY"                           },
    [0xa9] = { NES_OP_LDA, NES_ADDR_IMM, 2, "LDA #$%02"PRIX8                },
    [0xaa] = { NES_OP_TAX, NES_ADDR_IMP, 1, "TAX"                           },
    [0xab] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xac] = { NES_OP_LDY, NES_ADDR_ABS, 3, "LDY $%02"PRIX8"%02"PRIX8       },
    [0xad] = { NES_OP_LDA, NES_ADDR_ABS, 3, "LDA $%02"PRIX8"%02"PRIX8       },
    [0xae] = { NES_OP_LDX, NES_ADDR_ABS, 3, "LDX $%02"PRIX8"%02"PRIX8       },
    [0xaf] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xb0] = { NES_OP_BCS, NES_ADDR_REL, 2, "BCS $%02"PRIX8                 },
    [0xb1] = { NES_OP_LDA, NES_ADDR_INY, 2, "LDA ($%02"PRIX8"),Y"           },
    [0xb2] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xb3] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xb4] = { NES_OP_LDY, NES_ADDR_ZPX, 2, "LDY $%02"PRIX8",X"             },
    [0xb5] = { NES_OP_LDA, NES_ADDR_ZPX, 2, "LDA $%02"PRIX8",X"             },
    [0xb6] = { NES_OP_LDX, NES_ADDR_ZPY, 2, "LDX $%02"PRIX8",Y"             },
    [0xb7] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xb8] = { NES_OP_CLV, NES_ADDR_IMP, 1, "CLV"                           },
    [0xb9] = { NES_OP_LDA, NES_ADDR_ABY, 3, "LDA $%02"PRIX8"%02"PRIX8",Y"   },
    [0xba] = { NES_OP_TSX, NES_ADDR_IMP, 1, "TSX"                           },
    [0xbb] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xbc] = { NES_OP_LDY, NES_ADDR_ABX, 3, "LDY $%02"PRIX8"%02"PRIX8",X"   },
    [0xbd] = { NES_OP_LDA, NES_ADDR_ABX, 3, "LDA $%02"PRIX8"%02"PRIX8",X"   },
    [0xbe] = { NES_OP_LDX, NES_ADDR_ABY, 3, "LDX $%02"PRIX8"%02"PRIX8",Y"   },
    [0xbf] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xc0] = { NES_OP_CPY, NES_ADDR_IMM, 2, "CPY #$%02"PRIX8                },
    [0xc1] = { NES_OP_CMP, NES_ADDR_INX, 2, "CMP ($%02"PRIX8",X)"           },
    [0xc2] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0xc3] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xc4] = { NES_OP_CPY, NES_ADDR_ZPG, 2, "CPY $%02"PRIX8                 },
    [0xc5] = { NES_OP_CMP, NES_ADDR_ZPG, 2, "CMP $%02"PRIX8                 },
    [0xc6] = { NES_OP_DEC, NES_ADDR_ZPG, 2, "DEC $%02"PRIX8                 },
    [0xc7] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xc8] = { NES_OP_INY, NES_ADDR_IMP, 1, "INY"                           },
    [0xc9] = { NES_OP_CMP, NES_ADDR_IMM, 2, "CMP #$%02"PRIX8                },
    [0xca] = { NES_OP_DEX, NES_ADDR_IMP, 1, "DEX"                           },
    [0xcb] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xcc] = { NES_OP_CPY, NES_ADDR_ABS, 3, "CPY $%02"PRIX8"%02"PRIX8       },
    [0xcd] = { NES_OP_CMP, NES_ADDR_ABS, 3, "CMP $%02"PRIX8"%02"PRIX8       },
    [0xce] = { NES_OP_DEC, NES_ADDR_ABS, 3, "DEC $%02"PRIX8"%02"PRIX8       },
    [0xcf] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xd0] = { NES_OP_BNE, NES_ADDR_REL, 2, "BNE $%02"PRIX8                 },
    [0xd1] = { NES_OP_CMP, NES_ADDR_INY, 2, "CMP ($%02"PRIX8"),Y"           },
    [0xd2] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xd3] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xd4] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0xd5] = { NES_OP_CMP, NES_ADDR_ZPX, 2, "CMP $%02"PRIX8",X"             },
    [0xd6] = { NES_OP_DEC, NES_ADDR_ZPX, 2, "DEC $%02"PRIX8",X"             },
    [0xd7] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xd8] = { NES_OP_CLD, NES_ADDR_IMP, 1, "CLD"                           },
    [0xd9] = { NES_OP_CMP, NES_ADDR_ABY, 3, "CMP $%02"PRIX8"%02"PRIX8",Y"   },
    [0xda] = { NES_OP_NOP, NES_ADDR_IMP, 1, "NOP"                           },
    [0xdb] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xdc] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0xdd] = { NES_OP_CMP, NES_ADDR_ABX, 3, "CMP $%02"PRIX8"%02"PRIX8",X"   },
    [0xde] = { NES_OP_DEC, NES_ADDR_ABX, 3, "DEC $%02"PRIX8"%02"PRIX8",X"   },
    [0xdf] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xe0] = { NES_OP_CPX, NES_ADDR_IMM, 2, "CPX #$%02"PRIX8                },
    [0xe1] = { NES_OP_SBC, NES_ADDR_INX, 2, "SBC ($%02"PRIX8",X)"           },
    [0xe2] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0xe3] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xe4] = { NES_OP_CPX, NES_ADDR_ZPG, 2, "CPX $%02"PRIX8                 },
    [0xe5] = { NES_OP_SBC, NES_ADDR_ZPG, 2, "SBC $%02"PRIX8                 },
    [0xe6] = { NES_OP_INC, NES_ADDR_ZPG, 2, "INC $%02"PRIX8                 },
    [0xe7] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xe8] = { NES_OP_INX, NES_ADDR_IMP, 1, "INX"                           },
    [0xe9] = { NES_OP_SBC, NES_ADDR_IMM, 2, "SBC #$%02"PRIX8                },
    [0xea] = { NES_OP_NOP, NES_ADDR_IMP, 1, "NOP"                           },
    [0xeb] = { NES_OP_SBC, NES_ADDR_IMP, 1, "???"                           },
    [0xec] = { NES_OP_CPX, NES_ADDR_ABS, 3, "CPX $%02"PRIX8"%02"PRIX8       },
    [0xed] = { NES_OP_SBC, NES_ADDR_ABS, 3, "SBC $%02"PRIX8"%02"PRIX8       },
    [0xee] = { NES_OP_INC, NES_ADDR_ABS, 3, "INC $%02"PRIX8"%02"PRIX8       },
    [0xef] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xf0] = { NES_OP_BEQ, NES_ADDR_REL, 2, "BEQ $%02"PRIX8                 },
    [0xf1] = { NES_OP_SBC, NES_ADDR_INY, 2, "SBC ($%02"PRIX8"),Y"           },
    [0xf2] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xf3] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xf4] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0xf5] = { NES_OP_SBC, NES_ADDR_ZPX, 2, "SBC $%02"PRIX8",X"             },
    [0xf6] = { NES_OP_INC, NES_ADDR_ZPX, 2, "INC $%02"PRIX8",X"             },
    [0xf7] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xf8] = { NES_OP_SED, NES_ADDR_IMP, 1, "SED"                           },
    [0xf9] = { NES_OP_SBC, NES_ADDR_ABY, 3, "SBC $%02"PRIX8"%02"PRIX8",Y"   },
    [0xfa] = { NES_OP_NOP, NES_ADDR_IMP, 1, "NOP"                           },
    [0xfb] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
    [0xfc] = { NES_OP_NOP, NES_ADDR_IMP, 1, "???"                           },
    [0xfd] = { NES_OP_SBC, NES_ADDR_ABX, 3, "SBC $%02"PRIX8"%02"PRIX8",X"   },
    [0xfe] = { NES_OP_INC, NES_ADDR_ABX, 3, "INC $%02"PRIX8"%02"PRIX8",X"   },
    [0xff] = { NES_OP_XXX, NES_ADDR_IMP, 1, "???"                           },
};

Rp2a03Instruction* rp2a03_instruction_lookup(uint8_t opcode)
{
    // FIXME: sort the instructions or use a better algorithm to find the instructions
    return &instructions[opcode];
}
